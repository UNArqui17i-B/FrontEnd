<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.IronListBehaviorImpl=function(){var a=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),b=a&&8<=a[1];return{is:'iron-list',properties:{maxPhysicalCount:{type:Number,value:500},as:{type:String,value:'item'},indexAs:{type:String,value:'index'}},_ratio:0.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_physicalIndexForKey:null,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_collection:null,_itemsRendered:!1,_lastPage:null,_maxPages:3,_itemsPerRow:1,_itemWidth:0,_rowHeight:0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){return this._physicalSize-this._viewportHeight},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollerPaddingTop},_minVirtualStart:0,get _maxVirtualStart(){return Math.max(0,this._virtualCount-this._physicalCount)},_virtualStartVal:0,set _virtualStart(d){this._virtualStartVal=Math.min(this._maxVirtualStart,Math.max(this._minVirtualStart,d))},get _virtualStart(){return this._virtualStartVal||0},_physicalStartVal:0,set _physicalStart(d){this._physicalStartVal=d%this._physicalCount,0>this._physicalStartVal&&(this._physicalStartVal=this._physicalCount+this._physicalStartVal),this._physicalEnd=(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _physicalStart(){return this._physicalStartVal||0},_physicalCountVal:0,set _physicalCount(d){this._physicalCountVal=d,this._physicalEnd=(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _physicalCount(){return this._physicalCountVal},_physicalEnd:0,get _optPhysicalSize(){return this._viewportHeight*this._maxPages},get _optPhysicalCount(){return this._estRowsInView*this._itemsPerRow*this._maxPages},get _isVisible(){return this.scrollTarget&&!!(this.scrollTarget.offsetWidth||this.scrollTarget.offsetHeight)},get firstVisibleIndex(){if(null===this._firstVisibleIndexVal){var d=Math.floor(this._physicalTop+this._scrollerPaddingTop);this._firstVisibleIndexVal=this._iterateItems(function(e,f){if(d+=this._getPhysicalSizeIncrement(e),d>this._scrollPosition)return f})||0}return this._firstVisibleIndexVal},get lastVisibleIndex(){if(null===this._lastVisibleIndexVal){var d=this._physicalTop;this._iterateItems(function(e,f){if(d<this._scrollBottom)this._lastVisibleIndexVal=f;else return!0;d+=this._getPhysicalSizeIncrement(e)})}return this._lastVisibleIndexVal},get _defaultScrollTarget(){return this},get _virtualRowCount(){return Math.ceil(this._virtualCount/this._itemsPerRow)},get _estRowsInView(){return Math.ceil(this._viewportHeight/this._rowHeight)},get _physicalRows(){return Math.ceil(this._physicalCount/this._itemsPerRow)},attached:function(){this.updateViewportBoundaries(),this._render(),this.listen(this,'iron-resize','_resizeHandler')},detached:function(){this._itemsRendered=!1,this.unlisten(this,'iron-resize','_resizeHandler')},updateViewportBoundaries:function(){this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(window.getComputedStyle(this)['padding-top'],10),this._viewportHeight=this._scrollTargetHeight},_update:function(d,e){if(this._assignModels(d),this._updateMetrics(d),e)for(;e.length;){var f=e.pop();this._physicalTop-=this._getPhysicalSizeIncrement(f)}this._positionItems(),this._updateScrollerSize(),this._increasePoolIfNeeded()},_increasePoolIfNeeded:function(){if(0===this._viewportHeight)return!1;var d=this._physicalBottom>=this._scrollBottom&&this._physicalTop<=this._scrollPosition;if(this._physicalSize>=this._optPhysicalSize&&d)return!1;var e=Math.floor(this._physicalSize/this._viewportHeight);if(0===e)this._debounceTemplate(this._increasePool.bind(this,Math.round(0.5*this._physicalCount)));else if(this._lastPage!==e&&d)Polymer.dom.addDebouncer(this.debounce('_debounceTemplate',this._increasePool.bind(this,this._itemsPerRow),16));else{var f=this._physicalSize/this._physicalCount,g=this._viewportHeight/f,h=this._maxPages*g,j=Math.ceil(h-this._physicalCount);this._debounceTemplate(this._increasePool.bind(this,j||1))}return this._lastPage=e,!0},_increasePool:function(d){var e=Math.min(this._physicalCount+d,this._virtualCount-this._virtualStart,Math.max(this.maxPhysicalCount,25)),f=this._physicalCount,g=e-f;0>=g||([].push.apply(this._physicalItems,this._createPool(g)),[].push.apply(this._physicalSizes,Array(g)),this._physicalCount=f+g,this._update())},_render:function(){var d=0<this._virtualCount||0<this._physicalCount;this.isAttached&&!this._itemsRendered&&this._isVisible&&d&&(this._lastPage=0,this._update(),this._itemsRendered=!0)},_iterateItems:function(d,e){var f,g,h,j;if(2===arguments.length&&e){for(j=0;j<e.length;j++)if(f=e[j],g=this._computeVidx(f),null!=(h=d.call(this,f,g)))return h;}else{for(f=this._physicalStart,g=this._virtualStart;f<this._physicalCount;f++,g++)if(null!=(h=d.call(this,f,g)))return h;for(f=0;f<this._physicalStart;f++,g++)if(null!=(h=d.call(this,f,g)))return h}},_computeVidx:function(d){return d>=this._physicalStart?this._virtualStart+(d-this._physicalStart):this._virtualStart+(this._physicalCount-this._physicalStart)+d},_updateMetrics:function(d){Polymer.dom.flush();var e=0,f=0,g=this._physicalAverageCount,h=this._physicalAverage;this._iterateItems(function(j){f+=this._physicalSizes[j]||0,this._physicalSizes[j]=this._physicalItems[j].offsetHeight,e+=this._physicalSizes[j],this._physicalAverageCount+=this._physicalSizes[j]?1:0},d),this._viewportHeight=this._scrollTargetHeight,this._physicalSize=this._physicalSize+e-f,this._physicalAverageCount!==g&&(this._physicalAverage=Math.round((h*g+e)/this._physicalAverageCount))},_positionItems:function(){this._adjustScrollPosition();var d=this._physicalTop;this._iterateItems(function(e){this._physicalItems[e].style.transform=this._getTranslate(0,d),d+=this._physicalSizes[e]})},_getPhysicalSizeIncrement:function(d){return this._physicalSizes[d]},_shouldRenderNextRow:function(d){return d%this._itemsPerRow===this._itemsPerRow-1},_adjustScrollPosition:function(){var d=0===this._virtualStart?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);d&&(this._physicalTop-=d,!b&&0!==this._physicalTop&&this._resetScrollPosition(this._scrollTop-d))},_resetScrollPosition:function(d){this.scrollTarget&&(this._scrollTop=d,this._scrollPosition=this._scrollTop)},_updateScrollerSize:function(d){this._estScrollHeight=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage,d=d||0===this._scrollHeight,d=d||this._scrollPosition>=this._estScrollHeight-this._physicalSize,(d||Math.abs(this._estScrollHeight-this._scrollHeight)>=this._optPhysicalSize)&&(this.$.items.style.height=this._estScrollHeight+'px',this._scrollHeight=this._estScrollHeight)},scrollToIndex:function(d){Polymer.dom.flush(),d=Math.min(Math.max(d,0),this._virtualCount-1),(!this._isIndexRendered(d)||d>=this._maxVirtualStart)&&(this._virtualStart=d-1),this._assignModels(),this._updateMetrics();var e=Math.floor(this._virtualStart/this._itemsPerRow)*this._physicalAverage;this._physicalTop=e;for(var f=this._physicalStart,g=this._virtualStart,h=0,j=this._hiddenContentSize;g<d&&h<=j;)h+=this._getPhysicalSizeIncrement(f),f=(f+1)%this._physicalCount,g++;this._updateScrollerSize(!0),this._positionItems(),this._resetScrollPosition(this._physicalTop+this._scrollerPaddingTop+h),this._increasePoolIfNeeded(),this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null},_resetAverage:function(){this._physicalAverage=0,this._physicalAverageCount=0},_resizeHandler:function(){a&&100>Math.abs(this._viewportHeight-this._scrollTargetHeight),Polymer.dom.addDebouncer(this.debounce('_debounceTemplate',function(){this.updateViewportBoundaries(),this._render(),this._itemsRendered&&this._physicalItems&&this._isVisible&&(this._resetAverage(),this.scrollToIndex(this.firstVisibleIndex))}.bind(this),1))},updateSizeForItem:function(d){var e=this._physicalIndexForKey[d];null!=e&&(this._updateMetrics([e]),this._positionItems())},_isIndexRendered:function(d){return d>=this._virtualStart&&d<=this._virtualEnd},_isIndexVisible:function(d){return d>=this.firstVisibleIndex&&d<=this.lastVisibleIndex}}}(),vaadin.elements.grid.IronListBehavior=[Polymer.Templatizer,Polymer.IronScrollTargetBehavior,vaadin.elements.grid.IronListBehaviorImpl];</script></head><body></body></html>