<html><head><link rel="import" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"></head><body><dom-module id="vaadin-grid-table-scroll-styles"><template><style>:host{transform:translateZ(0);}thead{position:absolute;top:0;width:100%;}tfoot{position:absolute;bottom:0;width:100%;}tbody{z-index:-1;}table{position:relative;overflow:auto;-webkit-overflow-scrolling:touch;z-index:-2;}:host([ios]) table{transform:none;}:host([fixed-sections]){transform:translateZ(0);overflow:hidden;}:host([fixed-sections]) thead,
      :host([fixed-sections]) tfoot{position:fixed;}:host([fixed-sections]) tbody#items{position:fixed;width:100%;will-change:transform;}:host([fixed-sections]) table{transform:none;}</style></template></dom-module><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.TableScrollBehaviorImpl={properties:{_vidxOffset:{type:Number,value:0},ios:{type:Boolean,value:navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),reflectToAttribute:!0},fixedSections:{type:Boolean,reflectToAttribute:!0,computed:'_hasFixedSections(scrollbarWidth)'},_frozenCells:{type:Array,value:function(){return[]}},scrolling:{type:Boolean,reflectToAttribute:!0}},listeners:{'table.wheel':'_onWheel'},ready:function(){this.scrollTarget=this.$.table},scrollToScaledIndex:function(c){this._pendingScrollToScaledIndex=null,this.$.items.style.borderTopWidth||(this._pendingScrollToScaledIndex=c),c=Math.min(Math.max(c,0),this.size-1),this.$.table.scrollTop=c/this.size*this.$.table.scrollHeight,this._scrollHandler(),this.scrollToIndex(c-this._vidxOffset),this._resetScrollPosition(this._scrollPosition),this._scrollHandler(),this._vidxOffset+this.lastVisibleIndex===this.size-1&&(this.$.table.scrollTop=this.$.table.scrollHeight-this.$.table.offsetHeight,this._scrollHandler())},_hasFixedSections:function(c){return navigator.userAgent.match(/Edge/)&&0===c},_onWheel:function(c){if(!(c.ctrlKey||this._hasScrolledAncestor(c.target,c.deltaX,c.deltaY))){var d=this.$.table,f=Math.abs(c.deltaX)+Math.abs(c.deltaY);this._canScroll(d,c.deltaX,c.deltaY)?(c.preventDefault(),d.scrollTop+=c.deltaY,d.scrollLeft+=c.deltaX,this._scrollHandler(),this._hasResidualMomentum=!0,this._ignoreNewWheel=this.debounce('ignore-new-wheel',function(){this._ignoreNewWheel=null},500)):this._hasResidualMomentum&&f<=this._previousMomentum||this._ignoreNewWheel?c.preventDefault():f>this._previousMomentum&&(this._hasResidualMomentum=!1),this._previousMomentum=f}},_hasScrolledAncestor:function(c,d,f){if(this._canScroll(c,d,f))return!0;return'vaadin-grid-cell-content'!==c.localName&&c!==this&&c.parentElement?this._hasScrolledAncestor(c.parentElement,d,f):void 0},_canScroll:function(c,d,f){return 0<f&&c.scrollTop<c.scrollHeight-c.offsetHeight||0>f&&0<c.scrollTop||0<d&&c.scrollLeft<c.scrollWidth-c.offsetWidth||0>d&&0<c.scrollLeft},_scrollHandler:function(){var g,h,k,l,m,d=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop)),f=d-this._scrollPosition,n=this._ratio,o=0,p=this._hiddenContentSize,q=n,r=[];if(this._scrollPosition=d,this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,l=this._scrollBottom,m=this._physicalBottom,Math.abs(f)>this._physicalSize)this._physicalTop+=f,o=Math.round(f/this._physicalAverage);else if(0>f){var s=d-this._physicalTop,t=this._virtualStart;for(k=[],h=this._physicalEnd,q=s/p;q<n&&o<this._physicalCount&&0<t-o&&m-this._getPhysicalSizeIncrement(h)>l;)g=this._getPhysicalSizeIncrement(h),q+=g/p,m-=g,k.push(h),o++,h=0===h?this._physicalCount-1:h-1;r=k,o=-o}else if(0<f){var u=m-l,v=this._virtualEnd,w=this._virtualCount-1;for(k=[],h=this._physicalStart,q=u/p;q<n&&o<this._physicalCount&&v+o<w&&this._physicalTop+this._getPhysicalSizeIncrement(h)<d;)g=this._getPhysicalSizeIncrement(h),q+=g/p,this._physicalTop+=g,k.push(h),o++,h=(h+1)%this._physicalCount}this._virtualCount<this.size&&this._adjustVirtualIndexOffset(f),0===o?(m<l||this._physicalTop>d)&&this._increasePoolIfNeeded():(this._virtualStart+=o,this._physicalStart+=o,this._update(k,r)),this._translateStationaryElements(),this.hasAttribute('reordering')||(this.scrolling=!0),this.debounce('vaadin-grid-scrolling',function(){this.scrolling=!1,this._reorderRows()},100)},_adjustVirtualIndexOffset:function(c){if(1e4<Math.abs(c)){if(this._noScale)return void(this._noScale=!1);var d=Math.round(1e3*(this._scrollPosition/this._scrollHeight))/1e3,f=d*this.size;this._vidxOffset=Math.round(f-d*this._virtualCount),0===this._scrollTop&&this.scrollToIndex(0)}else{var g=this._vidxOffset||0,h=1e3,k=100;0===this._scrollTop?(this._vidxOffset=0,g!==this._vidxOffset&&this.scrollToIndex(0)):this.firstVisibleIndex<h&&0<this._vidxOffset&&(this._vidxOffset-=Math.min(this._vidxOffset,k),this.scrollToIndex(this.firstVisibleIndex+(g-this._vidxOffset)+1),this._noScale=!0);var l=this.size-this._virtualCount;this._scrollTop>=this._maxScrollTop?(this._vidxOffset=l,g!==this._vidxOffset&&this.scrollToIndex(this._virtualCount)):this.firstVisibleIndex>this._virtualCount-h&&this._vidxOffset<l&&(this._vidxOffset+=Math.min(l-this._vidxOffset,k),this.scrollToIndex(this.firstVisibleIndex-(this._vidxOffset-g)),this._noScale=!0)}},_reorderRows:function(){var c=Polymer.dom(this.$.items),d=c.querySelectorAll('tr'),f=this._virtualStart+this._vidxOffset,g=d.length-(d[0].index-f);if(g<d.length/2)for(var h=0;h<g;h++)c.appendChild(d[h]);else for(var k=g;k<d.length;k++)c.insertBefore(d[k],d[0])},_frozenCellsChanged:function(){this.debounce('cache-elements',function(){Polymer.dom(this.root).querySelectorAll('td, th').forEach(function(c){c.style.transform=''}),this._frozenCells=Polymer.dom(this.root).querySelectorAll('[frozen]'),this._translateStationaryElements()}),this._updateLastFrozen()},_updateLastFrozen:function(){if(this.columnTree){var c=this.columnTree[this.columnTree.length-1].slice(0);c.sort(function(f,g){return f._order-g._order});var d=c.reduce(function(f,g,h){return g._lastFrozen=!1,g.frozen&&!g.hidden?h:f},void 0);void 0!==d&&(c[d]._lastFrozen=!0)}},_translateStationaryElements:function(){this.fixedSections?(this.$.items.style.transform=this._getTranslate(-this._scrollLeft||0,-this._scrollTop||0),this.$.footer.style.transform=this.$.header.style.transform=this._getTranslate(-this._scrollLeft||0,0)):this.$.footer.style.transform=this.$.header.style.transform=this._getTranslate(0,this._scrollTop);for(var c=this._getTranslate(this._scrollLeft,0),d=0;d<this._frozenCells.length;d++)this._frozenCells[d].style.transform=c},_getTranslate:function(c,d){return'translate('+c+'px,'+d+'px)'}},vaadin.elements.grid.TableScrollBehavior=[Polymer.IronScrollTargetBehavior,vaadin.elements.grid.TableScrollBehaviorImpl];</script></body></html>