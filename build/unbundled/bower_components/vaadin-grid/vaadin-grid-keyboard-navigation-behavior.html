<html><head><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="import" href="../iron-a11y-announcer/iron-a11y-announcer.html"></head><body><dom-module id="vaadin-grid-navigation-themability-styles"><template><style>:host(:focus){outline:none;}:host([navigating]:not([interacting])) [focused] > tr[focused] > [focused] ::content > vaadin-grid-cell-content{box-shadow:inset 0 0 0 3px rgba(0, 0, 0, 0.3);@apply (--vaadin-grid-focused-cell);}</style></template></dom-module><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.KeyboardNavigationBehaviorImpl={hostAttributes:{tabindex:-1,role:'application'},keyBindings:{'ctrl+home':'_onCtrlHome','ctrl+end':'_onCtrlEnd',down:'_onArrowDown',end:'_onEnd',enter:'_onEnter',esc:'_onEscape',f2:'_onF2',home:'_onHome',left:'_onArrowLeft',pagedown:'_onPageDown',pageup:'_onPageUp',right:'_onArrowRight','shift+tab':'_onShiftTab',space:'_onSpace',tab:'_onTab',up:'_onArrowUp'},attached:function(){Polymer.IronA11yAnnouncer.requestAvailability()},_onEnd:function(a){this.$.scroller._onEnd(a)},_onEnter:function(a){this.$.scroller._onEnter(a)},_onEscape:function(a){this.$.scroller._onEscape(a)},_onF2:function(a){this.$.scroller._onF2(a)},_onTab:function(a){this.$.scroller._onTab(a)},_onShiftTab:function(a){this.$.scroller._onShiftTab(a)},_onArrowDown:function(a){this.$.scroller._onArrowDown(a)},_onArrowUp:function(a){this.$.scroller._onArrowUp(a)},_onArrowRight:function(a){this.$.scroller._onArrowRight(a)},_onArrowLeft:function(a){this.$.scroller._onArrowLeft(a)},_onHome:function(a){this.$.scroller._onHome(a)},_onCtrlHome:function(a){this.$.scroller._onCtrlHome(a)},_onCtrlEnd:function(a){this.$.scroller._onCtrlEnd(a)},_onPageDown:function(a){this.$.scroller._onPageDown(a)},_onPageUp:function(a){this.$.scroller._onPageUp(a)},_onSpace:function(a){this.$.scroller._onSpace(a)}},vaadin.elements.grid.KeyboardNavigationBehavior=[vaadin.elements.grid.KeyboardNavigationBehaviorImpl,Polymer.IronA11yKeysBehavior],vaadin.elements.grid.TableKeyboardBehavior={properties:{_virtualFocus:{type:Object,observer:'_virtualFocusChanged'},interacting:{type:Boolean,reflectToAttribute:!0,value:!1},navigating:{type:Boolean,reflectToAttribute:!0,value:!1}},listeners:{'cell-focus':'_onCellFocus','cell-content-focus':'_onCellContentFocus'},_isFooterVisible:function(){return 0<this.$.footer._rows.filter(function(a){return!a.hidden}).length},_onFocusout:function(){this.navigating=!1,this.interacting=!1},_onHeaderFocus:function(){this.navigating=!0,this.interacting=!1,this.$.header._focusedCellIndex=this.$.header._focusedCellIndex||0,this.$.header._focusedRowIndex=this.$.header._focusedRowIndex||0,this._virtualFocus=this.$.header},_onBodyFocus:function(){this.navigating=!0,this.interacting=!1,this.$.items._focusedCellIndex=this.$.items._focusedCellIndex||0,this.$.items._focusedRowIndex=this.$.items._focusedRowIndex||0,this._virtualFocus=this.$.items},_onFooterFocus:function(){this._isFooterVisible()?(this.navigating=!0,this.interacting=!1,this.$.footer._focusedCellIndex=this.$.footer._focusedCellIndex||0,this.$.footer._focusedRowIndex=this.$.footer._focusedRowIndex||0,this._virtualFocus=this.$.footer):!this._virtualFocus&&this.$.bodyFocusTrap.focus()},_virtualFocusChanged:function(a,b){b&&(b.focused=!1),a&&(a.focused=!0,a===this.$.items&&this._ensureVirtualFocusInViewport())},_onTab:function(a){if(!this.interacting&&this._virtualFocus)if(this.navigating)switch(this._virtualFocus){case this.$.header:this.$.bodyFocusTrap.focus(),a.preventDefault();break;case this.$.items:this.$.footerFocusTrap.focus(),this._isFooterVisible()?(this._virtualFocus=this.$.footer,a.preventDefault()):this.async(function(){this._virtualFocus=null},1);break;case this.$.footer:this._virtualFocus=null;}else{switch(this._virtualFocus){case this.$.header:this.$.headerFocusTrap.focus();break;case this.$.items:this.$.bodyFocusTrap.focus();break;case this.$.footer:this.$.footerFocusTrap.focus();}a.preventDefault()}},_onShiftTab:function(a){if(!this.interacting)if(this.navigating)switch(this._virtualFocus){case this.$.footer:this.$.bodyFocusTrap.focus(),a.preventDefault();break;case this.$.items:this.$.headerFocusTrap.focus(),a.preventDefault();break;case this.$.header:this._virtualFocus=null;}else{switch(this._virtualFocus){case this.$.footer:this.$.footerFocusTrap.focus();break;case this.$.items:this.$.bodyFocusTrap.focus();break;case this.$.header:this.$.headerFocusTrap.focus();}a.preventDefault()}},_isAboveViewport:function(a){return this.firstVisibleIndex>a},_onArrowDown:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusDown(),this._ensureVirtualFocusInViewport())},_scrollPageDown:function(){var a=this.$.header.getBoundingClientRect(),b=this.$.footer.getBoundingClientRect();this.$.table.scrollTop+=b.top-a.bottom,this._scrollHandler()},_onPageDown:function(a){if(!this.interacting)if(a.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var b=this.lastVisibleIndex;this._scrollPageDown(),this._virtualFocus._focusedRowIndex+=this.lastVisibleIndex-b||this.lastVisibleIndex-this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageDown()},_scrollPageUp:function(){var a=this.$.header.getBoundingClientRect(),b=this.$.footer.getBoundingClientRect();this.$.table.scrollTop-=b.top-a.bottom,this._scrollHandler()},_onPageUp:function(a){if(!this.interacting)if(a.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var b=this.lastVisibleIndex;this._scrollPageUp(),this._virtualFocus._focusedRowIndex-=b-this.lastVisibleIndex||this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageUp()},_onArrowUp:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusUp(),this._ensureVirtualFocusInViewport())},_onArrowRight:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusRight(),this._ensureVirtualFocusInViewport())},_onArrowLeft:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusLeft(),this._ensureVirtualFocusInViewport())},_onHome:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusHome(),this._ensureVirtualFocusInViewport())},_onEnd:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusEnd(),this._ensureVirtualFocusInViewport())},_moveFocusToFocusTarget:function(){var a=this._virtualFocus._focusedCell._cellContent,b=a.querySelector('[focus-target]')||a.firstElementChild;b&&b.focus()},_onEnter:function(a){this.interacting?'input'===a.detail.keyboardEvent.target.localName&&'text'===a.detail.keyboardEvent.target.type&&(this.interacting=!1,this._onTab(a)):(a.preventDefault(),this._moveFocusToFocusTarget())},_onEscape:function(a){this.interacting?(this.interacting=!1,this._onTab(a)):this.navigating&&this.domHost.focus()},_onF2:function(a){a.preventDefault(),this.interacting?(this.interacting=!1,this._onTab(a)):this._moveFocusToFocusTarget()},_onCtrlHome:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusFirst(),this._ensureVirtualFocusInViewport())},_onCtrlEnd:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusLast(),this._ensureVirtualFocusInViewport())},_onSpace:function(a){if(!this.interacting){a.preventDefault();var b=this._virtualFocus._focusedCell,c=b.getContentChildren('content')[0].firstElementChild;c?c.click():this.navigating&&this.fire('cell-activate',{model:b.instance})}},_onCellContentFocus:function(a){this.interacting=!0,this._onCellFocus(a)},_onCellFocus:function(a){var b=a.detail.cell,c=b.parentElement,d=c.parentElement,f=Polymer.dom(d).children.indexOf(c);d===this.$.items&&(f=c.index),d._focusedRowIndex=f,d._focusedCellIndex=Polymer.dom(c).children.indexOf(b),this._virtualFocus=d,b.hasAttribute('detailscell')&&(d._focusedCellIndex=0,d._moveFocusToDetailsCell())},_ensureVirtualFocusInViewport:function(){var a=this._vidxOffset+this._virtualStart,b=this._virtualFocus._focusedRowIndex;this._virtualFocus===this.$.items&&(b<a||b>a+this._physicalCount)?(this.scrollToScaledIndex(b),this._virtualFocus._focusedCellChanged(b,this._virtualFocus._focusedCellIndex)):this._ensureElementInViewport(this._virtualFocus._focusedCell)},_ensureElementInViewport:function(a){var b=a.getBoundingClientRect();if(this._virtualFocus===this.$.items){var c=this.$.footer.getBoundingClientRect().top,d=this.$.header.getBoundingClientRect().bottom;b.bottom>c?this.$.table.scrollTop+=b.bottom-c:b.top<d&&(this.$.table.scrollTop+=b.top-d)}if(!a.hasAttribute('detailscell')){var f=this.$.table.getBoundingClientRect().right,g=this.$.table.getBoundingClientRect().left,h=this._virtualFocus._focusedRow.querySelector('[last-frozen]');h&&(g=h.getBoundingClientRect().right),b.right>f?this.$.table.scrollLeft+=b.right-f:b.left<g&&(this.$.table.scrollLeft+=b.left-g)}}};</script></body></html>