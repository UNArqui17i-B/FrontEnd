<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-cell-click-behavior.html"></head><body><dom-module id="vaadin-grid-table-cell"></dom-module><dom-module id="vaadin-grid-table-header-cell"></dom-module><dom-module id="vaadin-grid-table-footer-cell"></dom-module><dom-module id="vaadin-grid-sizer-cell"></dom-module><script>(function(){var c={properties:{column:Object,expanded:Boolean,flexGrow:Number,focused:{type:Boolean,reflectToAttribute:!0},frozen:{type:Boolean,reflectToAttribute:!0},lastFrozen:{type:Boolean,reflectToAttribute:!0},hidden:{type:Boolean,reflectToAttribute:!0},instance:Object,index:Number,item:Object,selected:Boolean,template:Object,target:Object,width:String,order:Number,reorderStatus:{type:String,reflectToAttribute:!0},_childColumns:Array,_cellContent:Object,_insertionPoint:Object,_templatizer:Object},observers:['_columnChanged(column)','_cellAttached(column, isAttached)','_expandedChanged(expanded, instance)','_flexGrowChanged(flexGrow)','_indexChanged(index, instance)','_itemChanged(item, instance)','_instanceChanged(instance, target)','_selectedChanged(selected, instance)','_toggleContent(isAttached, _cellContent, _insertionPoint)','_toggleInstance(isAttached, _templatizer, instance)','_widthChanged(width)','_orderChanged(order)','_visibleChildColumnsChanged(_visibleChildColumns)','_childColumnsChanged(_childColumns)'],created:function(){this.classList.add('vaadin-grid-cell')},_columnChanged:function(d){this.flexGrow=d.flexGrow,this.frozen=d.frozen,this.lastFrozen=d._lastFrozen,this.headerTemplate=d.headerTemplate,this.footerTemplate=d.footerTemplate,this.template=d.template,this.width=d.width,this.hidden=d.hidden,this.resizable=d.resizable,this._childColumns=d._childColumns,this.order=d._order,d.colSpan&&this.setAttribute('colspan',d.colSpan),this.listen(d,'property-changed','_columnPropChanged')},_cellAttached:function(d,f){f?this.listen(d,'property-changed','_columnPropChanged'):this.unlisten(d,'property-changed','_columnPropChanged')},_columnPropChanged:function(d){d.target==this.column&&('colSpan'===d.detail.path?this.setAttribute('colspan',d.detail.value):this[d.detail.path]=d.detail.value)},_expandedChanged:function(d,f){f.__expanded__=d,f.expanded=d},_flexGrowChanged:function(d){this.style.flexGrow=d},_indexChanged:function(d,f){f.index=d},_itemChanged:function(d,f){f.item=d},_selectedChanged:function(d,f){f.__selected__=d,f.selected=d},_childColumnsChanged:function(d){this.setAttribute('colspan',d.length)},_toggleContent:function(d,f,g){d?(Polymer.dom(f).parentNode!==this.target&&Polymer.dom(this.target).appendChild(f),Polymer.dom(this).appendChild(g)):this.async(function(){this.isAttached||Polymer.dom(f).parentNode!==this.target||Polymer.dom(this.target).removeChild(f)})},_toggleInstance:function(d,f,g){d?f.addInstance(g):f.removeInstance(g)},_widthChanged:function(d){this.style.width=d},_orderChanged:function(d){this.style.order=d},_templateChanged:function(d){this.instance=d.templatizer.createInstance(),this._templatizer=d.templatizer},_instanceChanged:function(){this.style.height='',this._cellContent=document.createElement('vaadin-grid-cell-content');var g=vaadin.elements.grid._contentIndex=vaadin.elements.grid._contentIndex+1||0,h='vaadin-grid-cell-content-'+g;this._cellContent.setAttribute('id',h),Polymer.dom(this._cellContent).appendChild(this.instance.root),this._insertionPoint=document.createElement('content'),this._insertionPoint.setAttribute('select','#'+h)}};Polymer({is:'vaadin-grid-table-cell',extends:'td',behaviors:[c,vaadin.elements.grid.CellClickBehavior],observers:['_templateChanged(template)'],_cellClick:function(d){d.defaultPrevented||this.fire('cell-activate',{model:this.instance})}}),Polymer({is:'vaadin-grid-table-header-cell',extends:'th',properties:{headerTemplate:Object,resizable:Boolean,columnResizing:{type:Boolean,reflectToAttribute:!0}},behaviors:[c,vaadin.elements.grid.CellClickBehavior],observers:['_headerTemplateChanged(headerTemplate, isAttached)','_resizableChanged(resizable)'],listeners:{mousedown:'_cancelMouseDownOnResize',mousemove:'_enableDrag',mouseout:'_disableDrag',touchstart:'_onTouchStart',touchmove:'_onTouchMove',touchend:'_onTouchEnd',contextmenu:'_onContextMenu'},_onContextMenu:function(d){this._reorderGhost&&d.preventDefault()},_onTouchStart:function(d){d.target!==this._resizeHandle&&this.target.columnReorderingAllowed&&(this._startReorderTimeout=setTimeout(this._startReorder.bind(this,d),100))},_startReorder:function(d){this._reorderGhost=this._getGhost(),this._reorderGhost.style.visibility='visible';var f=new CustomEvent('dragstart',{bubbles:!0});this._cellContent.dispatchEvent(f),this._reorderXY={x:d.touches[0].clientX-this.getBoundingClientRect().left,y:d.touches[0].clientY-this.getBoundingClientRect().top},this._updateGhostPosition(d.touches[0].clientX,d.touches[0].clientY)},_onTouchMove:function(d){if(this._reorderGhost){d.preventDefault();var f=new CustomEvent('dragover',{bubbles:!0});f.clientX=d.touches[0].clientX,f.clientY=d.touches[0].clientY;var g=this._contentFromPoint(f.clientX,f.clientY);g&&g.dispatchEvent(f),this._updateGhostPosition(d.touches[0].clientX,d.touches[0].clientY)}else clearTimeout(this._startReorderTimeout)},_updateGhostPosition:function(d,f){var g=d-this._reorderXY.x,h=f-this._reorderXY.y-50,i=parseInt(this._reorderGhost.style.left||0),j=parseInt(this._reorderGhost.style.top||0),k=this._reorderGhost.getBoundingClientRect();this._reorderGhost.style.left=i-(k.left-g)+'px',this._reorderGhost.style.top=j-(k.top-h)+'px'},_onTouchEnd:function(d){if(clearTimeout(this._startReorderTimeout),this._reorderGhost){d.preventDefault();var f=new CustomEvent('dragend',{bubbles:!0});this.dispatchEvent(f),this._reorderGhost.style.visibility='hidden',this._reorderGhost=null}},_contentFromPoint:function(d,f){if(Polymer.Settings.useShadow){var g=this.target.$.scroller;g.toggleAttribute('no-content-pointer-events',!0);var h=g.root.elementFromPoint(d,f);if(g.toggleAttribute('no-content-pointer-events',!1),h&&h.getContentChildren)return h.getContentChildren('content')[0]}else return document.elementFromPoint(d,f)},_getGhost:function(){var d=this.target.$.scroller.$.reorderghost;d.innerText=this._cellContent.innerText;var f=window.getComputedStyle(this._cellContent);return['boxSizing','display','width','height','background','alignItems','padding','border','flex-direction','overflow'].forEach(function(g){d.style[g]=f[g]},this),d},_enableDrag:function(){this._cellContent.draggable=this.target.columnReorderingAllowed&&!window.getSelection().toString()},_disableDrag:function(){this._cellContent.draggable=!1},_cancelMouseDownOnResize:function(d){d.target===this._resizeHandle&&d.preventDefault()},_resizableChanged:function(d){d?(this._resizeHandle=document.createElement('div'),this._resizeHandle.classList.add('vaadin-grid-column-resize-handle'),this.listen(this._resizeHandle,'track','_onTrack'),Polymer.dom(this).appendChild(this._resizeHandle)):this._resizeHandle&&(this.unlisten(this._resizeHandle,'track','_onTrack'),Polymer.dom(this).removeChild(this._resizeHandle))},_onTrack:function(d){this.columnResizing=!0;var f=this.column;'vaadin-grid-column-group'===f.localName&&(f=f._childColumns.slice(0).sort(function(k,l){return k._order-l._order}).filter(function(k){return!k.hidden}).pop());var g=this._getHeaderCellByColumn(f);if(g.offsetWidth){var h=window.getComputedStyle(g._cellContent),i=10+parseInt(h.paddingLeft)+parseInt(h.paddingRight);f.width=Math.max(i,g.offsetWidth+d.detail.x-g.getBoundingClientRect().right)+'px',f.flexGrow=0}var j=this.parentElement.parentElement;Polymer.dom(j).querySelectorAll('tr:last-child th').sort(function(k,l){return k.column._order-l.column._order}).forEach(function(k,l,m){l<m.indexOf(g)&&(k.column.width=k.offsetWidth+'px',k.column.flexGrow=0)}),this.columnResizing&&'end'===d.detail.state&&(this.columnResizing=!1),this.fire('column-resizing')},_getHeaderCellByColumn:function(d){var f=this.parentElement.parentElement;return Polymer.dom(f).querySelectorAll('tr:last-child th').filter(function(g){return g.column===d})[0]},_headerTemplateChanged:function(d,f){null!==d&&(this._isColumnRow||'vaadin-grid-column-group'===this.column.localName)?(this._isEmpty=!1,this.instance=this.instance||d.templatizer.createInstance(),this._templatizer=d.templatizer):(this._isEmpty=!0,this.instance=this.instance||{root:document.createElement('div')}),f&&this.fire('cell-empty-changed')}}),Polymer({is:'vaadin-grid-table-footer-cell',extends:'td',properties:{footerTemplate:Object},behaviors:[c,vaadin.elements.grid.CellClickBehavior],observers:['_footerTemplateChanged(footerTemplate, isAttached)'],_footerTemplateChanged:function(d,f){null!==d&&(this._isColumnRow||'vaadin-grid-column-group'===this.column.localName)?(this._isEmpty=!1,this.instance=this.instance||d.templatizer.createInstance(),this._templatizer=d.templatizer):(this._isEmpty=!0,this.instance=this.instance||{root:document.createElement('div')}),f&&this.fire('cell-empty-changed')}}),Polymer({is:'vaadin-grid-sizer-cell',behaviors:[c]})})();</script></body></html>